(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[4747],{12648:function(Ce,P,e){"use strict";e.r(P),e.d(P,{default:function(){return me}});var ye=e(57338),N=e(25084),Fe=e(57663),E=e(71577),je=e(47673),z=e(4107),K=e(93224),S=e(2824),v=e(11849),Se=e(34792),g=e(48086),p=e(3182),H=e(94043),u=e.n(H),J=e(49101),y=e(67294),Q=e(75362),X=e(85224),k=e(16894),q=e(37476),V=e(5966),I=e(90672),_=e(12826),xe=e(71194),ee=e(5644),R=e(65554),b=e(64317),re=e(86615),ae=e(22452),r=e(85893),te=function(t){return(0,r.jsxs)(R.Z,{stepsProps:{size:"small"},stepsFormRender:function(o,a){return(0,r.jsx)(ee.Z,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u89C4\u5219\u914D\u7F6E",visible:t.updateModalVisible,footer:a,onCancel:function(){t.onCancel()},children:o})},onFinish:t.onSubmit,children:[(0,r.jsxs)(R.Z.StepForm,{initialValues:{name:t.values.name,desc:t.values.desc},title:"\u57FA\u672C\u4FE1\u606F",children:[(0,r.jsx)(V.Z,{name:"name",label:"\u89C4\u5219\u540D\u79F0",width:"md",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C4\u5219\u540D\u79F0\uFF01"}]}),(0,r.jsx)(I.Z,{name:"desc",width:"md",label:"\u89C4\u5219\u63CF\u8FF0",placeholder:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26\u7684\u89C4\u5219\u63CF\u8FF0\uFF01",min:5}]})]}),(0,r.jsxs)(R.Z.StepForm,{initialValues:{target:"0",template:"0"},title:"\u914D\u7F6E\u89C4\u5219\u5C5E\u6027",children:[(0,r.jsx)(b.Z,{name:"target",width:"md",label:"\u76D1\u63A7\u5BF9\u8C61",valueEnum:{0:"\u8868\u4E00",1:"\u8868\u4E8C"}}),(0,r.jsx)(b.Z,{name:"template",width:"md",label:"\u89C4\u5219\u6A21\u677F",valueEnum:{0:"\u89C4\u5219\u6A21\u677F\u4E00",1:"\u89C4\u5219\u6A21\u677F\u4E8C"}}),(0,r.jsx)(re.Z.Group,{name:"type",label:"\u89C4\u5219\u7C7B\u578B",options:[{value:"0",label:"\u5F3A"},{value:"1",label:"\u5F31"}]})]}),(0,r.jsxs)(R.Z.StepForm,{initialValues:{type:"1",frequency:"month"},title:"\u8BBE\u5B9A\u8C03\u5EA6\u5468\u671F",children:[(0,r.jsx)(ae.Z,{name:"time",width:"md",label:"\u5F00\u59CB\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4\uFF01"}]}),(0,r.jsx)(b.Z,{name:"frequency",label:"\u76D1\u63A7\u5BF9\u8C61",width:"md",valueEnum:{month:"\u6708",week:"\u5468"}})]})]})},ne=te,w=e(21010);function ue(d,t){return T.apply(this,arguments)}function T(){return T=(0,p.Z)(u().mark(function d(t,l){return u().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,w.WY)("/api/rule",(0,v.Z)({method:"GET",params:(0,v.Z)({},t)},l||{})));case 1:case"end":return a.stop()}},d)})),T.apply(this,arguments)}function se(d,t){return A.apply(this,arguments)}function A(){return A=(0,p.Z)(u().mark(function d(t,l){return u().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,w.WY)("/api/rule",(0,v.Z)({data:t,method:"PUT"},l||{})));case 1:case"end":return a.stop()}},d)})),A.apply(this,arguments)}function le(d,t){return B.apply(this,arguments)}function B(){return B=(0,p.Z)(u().mark(function d(t,l){return u().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,w.WY)("/api/rule",(0,v.Z)({data:t,method:"POST"},l||{})));case 1:case"end":return a.stop()}},d)})),B.apply(this,arguments)}function ie(d,t){return $.apply(this,arguments)}function $(){return $=(0,p.Z)(u().mark(function d(t,l){return u().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,w.WY)("/api/rule",(0,v.Z)({data:t,method:"DELETE"},l||{})));case 1:case"end":return a.stop()}},d)})),$.apply(this,arguments)}var de=function(){var d=(0,p.Z)(u().mark(function t(l){var o;return u().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=g.default.loading("\u6B63\u5728\u6DFB\u52A0"),n.prev=1,n.next=4,le((0,v.Z)({},l));case 4:return o(),g.default.success("\u6DFB\u52A0\u6210\u529F"),n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(1),o(),g.default.error("\u6DFB\u52A0\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),n.abrupt("return",!1);case 14:case"end":return n.stop()}},t,null,[[1,9]])}));return function(l){return d.apply(this,arguments)}}(),oe=function(){var d=(0,p.Z)(u().mark(function t(l,o){var a;return u().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return a=g.default.loading("\u6B63\u5728\u914D\u7F6E"),f.prev=1,f.next=4,se((0,v.Z)((0,v.Z)({},o),l));case 4:return a(),g.default.success("\u914D\u7F6E\u6210\u529F"),f.abrupt("return",!0);case 9:return f.prev=9,f.t0=f.catch(1),a(),g.default.error("\u914D\u7F6E\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),f.abrupt("return",!1);case 14:case"end":return f.stop()}},t,null,[[1,9]])}));return function(l,o){return d.apply(this,arguments)}}(),ce=function(){var d=(0,p.Z)(u().mark(function t(l){var o;return u().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=g.default.loading("\u6B63\u5728\u5220\u9664"),l){n.next=3;break}return n.abrupt("return",!0);case 3:return n.prev=3,n.next=6,ie({key:l.map(function(f){return f.key})});case 6:return o(),g.default.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),n.abrupt("return",!0);case 11:return n.prev=11,n.t0=n.catch(3),o(),g.default.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),n.abrupt("return",!1);case 16:case"end":return n.stop()}},t,null,[[3,11]])}));return function(l){return d.apply(this,arguments)}}(),fe=function(){var t=(0,y.useState)(!1),l=(0,S.Z)(t,2),o=l[0],a=l[1],n=(0,y.useState)(!1),f=(0,S.Z)(n,2),he=f[0],D=f[1],pe=(0,y.useState)(!1),U=(0,S.Z)(pe,2),ve=U[0],M=U[1],F=(0,y.useRef)(),Ze=(0,y.useState)(),W=(0,S.Z)(Ze,2),h=W[0],x=W[1],ge=(0,y.useState)([]),L=(0,S.Z)(ge,2),j=L[0],O=L[1],Y=[{title:"Rule Name",dataIndex:"name",tip:"Unique key",render:function(s,i){return(0,r.jsx)("a",{onClick:function(){x(i),M(!0)},children:s})}},{title:"Description",dataIndex:"desc",valueType:"textarea"},{title:"Callback",dataIndex:"callNo",sorter:!0,hideInForm:!0,renderText:function(s){return"".concat(s,"\u4E07")}},{title:"Status",dataIndex:"status",hideInForm:!0,valueEnum:{0:{text:"Closed",status:"Default"},1:{text:"Running",status:"Processing"},2:{text:"Release",status:"Success"},3:{text:"Error",status:"Error"}}},{title:"Last access",sorter:!0,dataIndex:"updatedAt",valueType:"dateTime",renderFormItem:function(s,i,Z){var C=i.defaultRender,m=(0,K.Z)(i,["defaultRender"]),G=Z.getFieldValue("status");return"".concat(G)==="0"?!1:"".concat(G)==="3"?(0,r.jsx)(z.Z,(0,v.Z)((0,v.Z)({},m),{},{placeholder:"Please input issue\uFF01"})):C(s)}},{title:"Option",dataIndex:"option",valueType:"option",render:function(s,i){return[(0,r.jsx)("a",{onClick:function(){D(!0),x(i)},children:"Config"},"config"),(0,r.jsx)("a",{href:"https://procomponents.ant.design/",children:"Focus warning"},"subscribeAlert")]}}];return(0,r.jsxs)(Q.ZP,{breadcrumbRender:!1,children:[(0,r.jsx)(k.ZP,{headerTitle:"Search",actionRef:F,rowKey:"key",search:{labelWidth:120},toolBarRender:function(){return[(0,r.jsxs)(E.Z,{type:"primary",onClick:function(){a(!0)},children:[(0,r.jsx)(J.Z,{})," Create"]},"primary")]},request:ue,columns:Y,rowSelection:{onChange:function(s,i){O(i)}}}),(j==null?void 0:j.length)>0&&(0,r.jsxs)(X.Z,{extra:(0,r.jsxs)("div",{children:["Selected"," ",(0,r.jsx)("a",{style:{fontWeight:600},children:j.length})," ","record \xA0\xA0",(0,r.jsxs)("span",{children:["Total access ",j.reduce(function(c,s){return c+s.callNo},0)," \u4E07"]})]}),children:[(0,r.jsx)(E.Z,{onClick:(0,p.Z)(u().mark(function c(){var s,i;return u().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,ce(j);case 2:O([]),(s=F.current)===null||s===void 0||(i=s.reloadAndRest)===null||i===void 0||i.call(s);case 4:case"end":return C.stop()}},c)})),children:"Batch Delete"}),(0,r.jsx)(E.Z,{type:"primary",children:"Batch Approve"})]}),(0,r.jsxs)(q.Z,{title:"Create rule",width:"400px",visible:o,onVisibleChange:a,onFinish:function(){var c=(0,p.Z)(u().mark(function s(i){var Z;return u().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,de(i);case 2:Z=m.sent,Z&&(a(!1),F.current&&F.current.reload());case 4:case"end":return m.stop()}},s)}));return function(s){return c.apply(this,arguments)}}(),children:[(0,r.jsx)(V.Z,{rules:[{required:!0,message:"Rule name required"}],width:"md",name:"name"}),(0,r.jsx)(I.Z,{width:"md",name:"desc"})]}),(0,r.jsx)(ne,{onSubmit:function(){var c=(0,p.Z)(u().mark(function s(i){var Z;return u().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,oe(i,h);case 2:Z=m.sent,Z&&(D(!1),x(void 0),F.current&&F.current.reload());case 4:case"end":return m.stop()}},s)}));return function(s){return c.apply(this,arguments)}}(),onCancel:function(){D(!1),x(void 0)},updateModalVisible:he,values:h||{}}),(0,r.jsx)(N.Z,{width:600,visible:ve,onClose:function(){x(void 0),M(!1)},closable:!1,children:(h==null?void 0:h.name)&&(0,r.jsx)(_.Z,{column:2,title:h==null?void 0:h.name,request:(0,p.Z)(u().mark(function c(){return u().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",{data:h||{}});case 1:case"end":return i.stop()}},c)})),params:{id:h==null?void 0:h.name},columns:Y})})]})},me=fe}}]);
